<?php

$programLeasingData = [
   [
      "section" => "passenger-vehicles",
      "image" => "photo-1.png",
      "title" => "Приобрести легковой автомобиль — легко",
      "text" => "Мы передаем в лизинг легковые автомобили с различным типом кузова: седан, лифтбек, внедорожник, купе, пикапы, фургоны и др. \n \n У нас представлены все самые востребованные и актуальные марки на настоящий день: ...",
      "obtainingLeasing" => [
         "minAdvance" => 5,
         "maxLeasingPeriod" => "5 лет",
         "minRedemptionPayment" => 1200,
      ],
      "requirementsLessees" => [
         [
            "title" => "Организационно-правовая форма",
            "text" => "ООО, ОАО, ПАО, ЗАО, ИП, бюджетные организации"
         ],
         [
            "title" => "Место основной деятельности",
            "text" => "Все регионы РФ"
         ],
         [
            "title" => "Срок деятельности лизингополучателя",
            "text" => "От 1 года"
         ],
      ],
      "suppliers" => [
         "20-mezcentr.svg",
         "8-pkuspt.svg",
         "21-logo.svg"
      ]
   ],
   [
      "section" => "freight-transport",
      "image" => "photo-2.png",
      "title" => "Серьезная техника для крупного \n  производства",
      "text" => "У нас в наличии: тягачи, самосвалы, рефрижераторы,  фургоны, бортовые грузовики  и другие виды, индивидуально подобранные под ваш бизнес.  \n\n Мы отдаём предпочтение самым надёжным производителям грузового автотранспорта из России, работаем с проверенными поставщиками — УралСпецТранс, АГРО-Лидер, МАЗ Центр Челябинск, ПК УСПТ.",
      "obtainingLeasing" => [
         "minAdvance" => 5,
         "maxLeasingPeriod" => "5 лет",
         "minRedemptionPayment" => 1200,
      ],
      "requirementsLessees" => [
         [
            "title" => "Организационно-правовая форма",
            "text" => "ООО, ОАО, ПАО, ЗАО, ИП, бюджетные организации"
         ],
         [
            "title" => "Место основной деятельности",
            "text" => "Все регионы РФ"
         ],
         [
            "title" => "Срок деятельности лизингополучателя",
            "text" => "От 1 года"
         ],
      ],
      "suppliers" => [
         "1-zoomlin.svg",
         "8-pkuspt.svg",
         "20-mezcentr.svg",
         "9-UralSpecTrans.svg",
         "2-translift.svg ",

      ]
   ],
   [
      "section" => "special-equipment",
      "image" => "photo-3.png",
      "title" => "Своя спецтехника — \n свой вектор развития",
      "text" => "У нас представлена техника под любой запрос бизнеса и производства: сельхоз, лесозаготовительная, дорожная, строительная, коммунальная, складская и др. \n\n  Мы сотрудничаем только с надёжными производителями, поставляющими качественные машины: Zoomlion, УралСпецТранс, АГРО-Лидер, ТрансЛифтТехника, МАЗ Центр Челябинск, ПК УСПТ, ЛБР, Агродок, 1-Я ОПАЛУБОЧНАЯ КОМПАНИЯ.",
      "obtainingLeasing" => [
         "minAdvance" => 5,
         "maxLeasingPeriod" => "5 лет",
         "minRedemptionPayment" => 1200,
      ],
      "requirementsLessees" => [
         [
            "title" => "Организационно-правовая форма",
            "text" => "ООО, ОАО, ПАО, ЗАО, ИП, бюджетные организации"
         ],
         [
            "title" => "Место основной деятельности",
            "text" => "Все регионы РФ"
         ],
         [
            "title" => "Срок деятельности лизингополучателя",
            "text" => "От 1 года"
         ],
      ],
      "suppliers" => [
         "1-zoomlin.svg",
         "6-agrodoc.svg",
         "11-LBR.svg",
         "5-agrolider.svg",

      ]
   ],
   [
      "section" => "equipment",
      "image" => "photo-4.png",
      "title" => "Высокотехнологичное \n производство с выгодой",
      "text" => "Оборудование под специальный запрос: для металлообрабатывающего, пищевого, строительного, деревообрабатывающего, строительного  производства. Подберём оборудование под ваш запрос. \n\n Мы поддерживаем российского производителя, именно поэтому участвуем в программе  «Лизинговые проекты» Фонда развития промышленности и предоставляем заём до 27% от общей стоимости российского оборудования. \n\n Работаем со следующими поставщиками: ТрансЛифтТехника, ГСИ-Екатеринбург, FoodProm, РУСТорг, ЛБР, MEDLIGA, 1-Я ОПАЛУБОЧНАЯ КОМПАНИЯ.",
      "obtainingLeasing" => [
         "minAdvance" => 20,
         "maxLeasingPeriod" => "5 лет",
         "minRedemptionPayment" => 1200,
      ],
      "requirementsLessees" => [
         [
            "title" => "Организационно-правовая форма",
            "text" => "ООО, ОАО, ПАО, ЗАО, ИП, бюджетные организации"
         ],
         [
            "title" => "Место основной деятельности",
            "text" => "Все регионы РФ"
         ],
         [
            "title" => "Срок деятельности лизингополучателя",
            "text" => "От 1 года"
         ],
      ],
      "suppliers" => [
         "4-jood.svg",
         "7-rustorg.svg",
         "3-medizina",
         "10-geocentr.svg",
      ]
   ],
   [
      "section" => "medical-equipment",
      "image" => "photo-5.png",
      "title" => "Делаем доступными передовые \n медицинские технологии ",
      "text" => "Повышаем качество медицинских услуг посредством лизинга медицинского оборудования для клиник, фармацевтической промышленности и исследовательских центров. \n\n Мы сотрудничаем с федеральной компанией MEDLIGA, которая является официальным дистрибьютором профессионального медицинского оборудования: Mindray, Canon, Pentax, General Electric, Samsung, Siemens, Olympus, Электрон, С.П. Гелпик, ЭМА .",
      "obtainingLeasing" => [
         "minAdvance" => 20,
         "maxLeasingPeriod" => "60 мес",
         "minRedemptionPayment" => 1200,
      ],
      "requirementsLessees" => [
         [
            "title" => "Организационно-правовая форма",
            "text" => "ООО, ОАО, ПАО, ЗАО, ИП, бюджетные организации"
         ],
         [
            "title" => "Место основной деятельности",
            "text" => "Все регионы РФ"
         ],
         [
            "title" => "Срок деятельности лизингополучателя",
            "text" => "От 1 года"
         ],
      ],
      "suppliers" => [
         "3-medizina.svg",
      ]
   ],
   [
      "section" => "restaurant-equipment",
      "image" => "photo-6.png",
      "title" => "Мишленовские звезды с нашим \n оборудованием — реальность",
      "text" => "Качественный сервис и вкусная еда начинается с технологичного ресторанного оборудования.  У нас можно взять \n в лизинг кухонные процессоры, пароконвектоматы, плиты, холодильные витрины и др. \n\n Нам поставляют оборудование надёжные партнёры, такие как FoodProm и РУСТорг.",
      "obtainingLeasing" => [
         "minAdvance" => 20,
         "maxLeasingPeriod" => "5 лет",
         "minRedemptionPayment" => 1200,
      ],
      "requirementsLessees" => [
         [
            "title" => "Организационно-правовая форма",
            "text" => "ООО, ОАО, ПАО, ЗАО, ИП, бюджетные организации"
         ],
         [
            "title" => "Место основной деятельности",
            "text" => "Все регионы РФ"
         ],
         [
            "title" => "Срок деятельности лизингополучателя",
            "text" => "От 1 года"
         ],
      ],
      "suppliers" => [
         "4-jood.svg",
         "7-rustorg.svg",
      ]
   ],
   [
      "section" => "used-products",
      "image" => "photo-7.png",
      "title" => "Продлеваем срок действия \n качественных машин",
      "text" => "К поддержанной продукции, сдаваемой в лизинг, мы относим легковой и грузовой транспорт не старше 5 лет. \n\n У нас всё «прозрачно», ведь перед оформлением договора вы можете проверить документы и состояние продукции.\n Выгода лизинга  б/у транспорта составляет 40% перед лизингом аналогичных новых машин. \n\n Мы работаем только с проверенными поставщиками АГРО-Лидер и ГСИ , поэтому уверены в качестве продукции.",
      "obtainingLeasing" => [
         "minAdvance" => 20,
         "maxLeasingPeriod" => "5 года",
         "minRedemptionPayment" => 1200,
      ],
      "requirementsLessees" => [
         [
            "title" => "Организационно-правовая форма",
            "text" => "ООО, ОАО, ПАО, ЗАО, ИП, бюджетные организации"
         ],
         [
            "title" => "Место основной деятельности",
            "text" => "Все регионы РФ"
         ],
         [
            "title" => "Срок деятельности лизингополучателя",
            "text" => "От 1 года"
         ],
      ],
      "suppliers" => [
         "1-zoomlin.svg",
         "4-jood.svg",
         "20-mezcentr.svg",
         "2-translift.svg",
         "8-pkuspt.svg",
         "9-UralSpecTrans.svg",
         "7-rustorg.svg",
         "6-agrodoc.svg",
         "10-geocentr.svg",
         "5-agrolider.svg",
         "11-LBR.svg",
      ]
   ],
   [
      "section" => "real-estate",
      "image" => "photo-8.png",
      "title" => "Выгодная альтернатива аренде — \n помещение станет вашим",
      "text" => "Компания А5 предоставляет большой спектр видов недвижимости: дома, квартиры. офисы, торговые площадки, склады и др. Можем подобрать любое помещение под ваш запрос. \n\n Вам нужно только выбрать помещение из нашего списка, мы передаём вам сведения комплексной экспертизы, менеджер А5  заключает договор лизинга и купли-продажи.",
      "obtainingLeasing" => [
         "minAdvance" => 30,
         "maxLeasingPeriod" => "5 лет",
         "minRedemptionPayment" => 1200,
      ],
      "requirementsLessees" => [
         [
            "title" => "Организационно-правовая форма",
            "text" => "ООО, ОАО, ПАО, ЗАО, ИП, бюджетные организации"
         ],
         [
            "title" => "Место основной деятельности",
            "text" => "Все регионы РФ"
         ],
         [
            "title" => "Срок деятельности лизингополучателя",
            "text" => "От 1 года"
         ],
      ],
      "suppliers" => []
   ],

];



$activeNavItem = isset($_GET['section']) ? $_GET['section'] : '';

// Функция для поиска данных по активной секции
function getProgramData($programLeasingData, $activeNavItem)
{
   foreach ($programLeasingData as $program) {
      if ($program['section'] === $activeNavItem) {
         return $program;
      }
   }
   return null;
}

$activeProgram = getProgramData($programLeasingData, $activeNavItem);


?>

<section class="grid_1-3-box container">
   <div class="program-leasing-page__navigation grid_1-3_1">
      <h3>Программы лизинга</h3>
      <ul>
         <li>
            <a href="?section=passenger-vehicles" class="<?php if ($activeNavItem === 'passenger-vehicles') echo 'program__navigation--active'; ?>">Легковой автотранспорт</a>
         </li>
         <li>
            <a href="?section=freight-transport" class="<?php if ($activeNavItem === 'freight-transport') echo 'program__navigation--active'; ?>">Грузовой автотранспорт</a>
         </li>
         <li>
            <a href="?section=special-equipment" class="<?php if ($activeNavItem === 'special-equipment') echo 'program__navigation--active'; ?>">Спецтехника</a>
         </li>
         <li>
            <a href="?section=equipment" class="<?php if ($activeNavItem === 'equipment') echo 'program__navigation--active'; ?>">Оборудование</a>
         </li>
         <li>
            <a href="?section=medical-equipment" class="<?php if ($activeNavItem === 'medical-equipment') echo 'program__navigation--active'; ?>">Медицинское оборудование</a>
         </li>
         <li>
            <a href="?section=restaurant-equipment" class="<?php if ($activeNavItem === 'restaurant-equipment') echo 'program__navigation--active'; ?>">Ресторанное оборудование</a>
         </li>
         <li>
            <a href="?section=used-products" class="<?php if ($activeNavItem === 'used-products') echo 'program__navigation--active'; ?>">Б/У продукция</a>
         </li>
         <li>
            <a href="?section=real-estate" class="<?php if ($activeNavItem === 'real-estate') echo 'program__navigation--active'; ?>">Недвижимость</a>
         </li>
      </ul>
   </div>

   <div class="program-leasing-page__content grid_1-3_3">
      <?php if ($activeProgram) : ?>
         <div class="program-leasing-page__image">
            <img src="<?php echo IMG_PATH . 'program-leasing-page/' . htmlspecialchars($activeProgram['image']); ?>" alt="">
         </div>
         <h3><?php echo htmlspecialchars($activeProgram['title']); ?></h3>
         <div>
            <p><?php echo nl2br(htmlspecialchars($activeProgram['text'])); ?></p>
         </div>
      <?php endif; ?>
   </div>
</section>

<section class="grid_1-3-box container obtaining-leasing">
   <?php if ($activeProgram) : ?>
      <div class="grid_1-3_1">
         <p class="p20px">
            Условия получения лизинга <br> в выбранной нише:
         </p>
      </div>
      <div class="grid_1-3_3 obtaining-leasing__content">
         <div class="obtaining-leasing__content--item">
            <h4><?php echo htmlspecialchars($activeProgram['obtainingLeasing']['minAdvance']) . '%'; ?></h4>
            <p>Минимальный аванс</p>
         </div>
         <div class="obtaining-leasing__content--item">
            <h4><?php echo htmlspecialchars($activeProgram['obtainingLeasing']['maxLeasingPeriod']); ?></h4>
            <p>Максимальный срок лизинга</p>
         </div>
         <div class="obtaining-leasing__content--item">
            <h4><?php echo htmlspecialchars($activeProgram['obtainingLeasing']['minRedemptionPayment']) . ' ₽'; ?></h4>
            <p>Минимальный выкупной платёж</p>
         </div>
      </div>
   <?php endif; ?>
</section>

<section class="grid_1-3-box container requirements">
   <?php if ($activeProgram) : ?>
      <div class="grid_1-3_1 requirements__title">
         <p class="p20px">
            Основные требования <br> к лизингополучателям
         </p>
      </div>
      <ul class="grid_1-3_3 requirements__content">
         <?php foreach ($activeProgram['requirementsLessees'] as $requirement) : ?>
            <li class="requirements__content--item">
               <h4><?php echo htmlspecialchars($requirement['title']); ?></h4>
               <p><?php echo htmlspecialchars($requirement['text']); ?></p>
            </li>
         <?php endforeach; ?>
      </ul>
   <?php endif; ?>
</section>

<section class="grid_1-3-box container mt-160px">
   <div class="grid_1-3_1">
      <p class="p20px">
         Калькулятор лизинга
      </p>
   </div>
   <div class="grid_1-3_3 program-leasing-calculator">
      <?php
      include 'src/components/ui/calculator/calculator.php';
      include 'src/components/ui/calculator-result/index.php';
      ?>
   </div>
</section>

<section class="grid_1-3-box container mt-160px">
   <div class="grid_1-3_1">
      <p class="p20px">
         Поставщики
      </p>
   </div>
   <div class="grid_1-3_3 program-leasing__slider">
      <div class="slider__box">
         <div class="slider__container">
            <?php if ($activeProgram) : ?>
               <?php foreach ($activeProgram['suppliers'] as $slide) : ?>
                  <div class="slider__slide">
                     <img class="slider__image" src="<?php echo SVG_PATH . 'custom-slider/' . (!empty($slide) ? htmlspecialchars($slide) : 'placeholder.png'); ?>" alt="logo">
                  </div>
               <?php endforeach; ?>
            <?php endif; ?>
         </div>
      </div>
      <div class="slider__buttons">
         <button class="slider__button slider__button--prev" type="button" id="prevButton">
            <svg class="slider__icon" width="50" height="50" viewBox="0 0 50 50">
               <use href="<?php echo SVG_PATH; ?>icons.svg#icon-arrow-left-circle"></use>
            </svg>
         </button>
         <button class="slider__button slider__button--next" type="button" id="nextButton">
            <svg class="slider__icon" width="50" height="50" viewBox="0 0 50 50">
               <use href="<?php echo SVG_PATH; ?>icons.svg#icon-arrow-left-circle"></use>
            </svg>
         </button>
      </div>
   </div>
</section>






<script>
   $(document).ready(function() {
      const $sliderContainer = $(".program-leasing__slider .slider__container");
      if ($sliderContainer.children().length > 3) {
         const $slides = $sliderContainer.children();
         const slideCount = $slides.length;
         const slideWidth = Math.ceil($(".program-leasing__slider .slider__slide").outerWidth()) + 40;
         const step = -slideWidth;
         const timeAnimate = 700;
         let isAnimating = false;
         // Копируем первые два слайда и добавляем их в конец контейнера
         $slides.slice(0, 2).clone().appendTo($sliderContainer);
         // Копируем последние два слайда и добавляем их в начало контейнера
         $slides.slice(-2).clone().prependTo($sliderContainer);
         $sliderContainer.css("left", -slideWidth * 2 + "px");

         $(".program-leasing__slider .slider__button--prev").click(function() {
            if (!isAnimating) {
               isAnimating = true;
               const currentLeft = parseInt($sliderContainer.css("left")) || 0;
               $sliderContainer.animate({
                  left: (currentLeft - step) + "px"
               }, timeAnimate, function() {
                  if (parseInt($sliderContainer.css("left")) >= 0) {
                     $sliderContainer.css("left", -slideCount * slideWidth + "px");
                  }
                  isAnimating = false;
               });
            }
         });

         $(".program-leasing__slider  .slider__button--next").click(function() {
            if (!isAnimating) {
               isAnimating = true;
               const currentLeft = parseInt($sliderContainer.css("left")) || 0;
               $sliderContainer.animate({
                  left: (currentLeft + step) + "px"
               }, timeAnimate, function() {
                  if (parseInt($sliderContainer.css("left")) <= -(slideCount + 1) * slideWidth) {
                     $sliderContainer.css("left", -slideWidth + "px");
                  }
                  isAnimating = false;
               });
            }
         });
      } else {
         $(".program-leasing__slider .slider__buttons").css('display', 'none');
      }
   });
</script>

<style>
   .program-leasing__slider {
      display: flex;
      grid-area: 1 / 2 / 2 / 5;
      flex-direction: column;
      gap: 20px;
      align-items: flex-end;
      position: relative;
   }

   .program-leasing__slider .slider__buttons {
      display: flex;
      gap: 20px;
      max-width: 120px;
      bottom: 0;
      position: absolute;
      left: -140px;
   }

   .program-leasing__slider .slider__button {
      width: 50px;
      height: 50px;
   }

   .program-leasing__slider .slider__button--next {
      transform: rotate(180deg);
   }

   .program-leasing__slider .slider__button:disabled .slider__icon {
      stroke: gray;
      fill: #fff;
   }

   .program-leasing__slider .slider__button:hover:disabled .slider__icon {
      fill: #fff;
      stroke: gray;
      --stroke-width: 2px;
      --circle-radius: 24;
   }

   .program-leasing__slider .slider__icon {
      fill: #fff;
      stroke: #0045B2;
      transition: all 200ms ease;
   }

   .program-leasing__slider .slider__button:hover .slider__icon {
      fill: #0045B2;
      stroke: #fff;
      --stroke-width: 0;
      --circle-radius: 25;
      transition: all 200ms ease;
   }

   .program-leasing__slider .slider__box {
      position: relative;
      height: 410px;
      width: 100%;
      overflow: hidden;
   }

   .program-leasing__slider .slider__container {
      position: absolute;
      top: 0px;
      display: flex;
      height: 100%;
   }


   .program-leasing__slider .slider__slide {
      width: 410px;
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
      margin-right: 40px;
      background-color: var(--back-gray-light);
      justify-content: flex-start;
      align-items: center;
      overflow: hidden;
   }

   .program-leasing__slider .slider__image {
      width: 100%;
      height: 100%;
      object-fit: none;
   }
</style>

<style>
   /* ----------------- */
   .program-leasing-calculator {
      display: flex;
      justify-content: space-between;
   }

   /* ----------------- */
   .requirements__content--item {
      display: flex;
      border-top: 1px solid #979797;
      padding: 35px 0;
   }

   .requirements__content--item:last-child {
      border-bottom: 1px solid #979797;
   }

   .requirements__content--item h4 {
      font-size: 24px;
      line-height: 24px;
      width: calc(50% - 20px);
      color: #0045B2;
   }

   .requirements__content--item p {
      width: calc(50% - 20px);
      color: #515151;
      line-height: 21.78px;
   }

   /* ----------------- */

   .obtaining-leasing {
      margin: 100px 0;
   }

   .obtaining-leasing__content {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 40px;
   }

   .obtaining-leasing__content--item p {
      font-size: 16px;
      line-height: 16px;
      color: #979797;
   }

   .obtaining-leasing__content--item h4 {
      font-size: 48px;
      font-weight: 500;
      margin-bottom: 10px;
      line-height: 58.08px;
      color: #0045B2;
   }

   /* ----------------- */

   .program-leasing-page__content {
      font-size: 70px;
      line-height: 84px;
      color: #0045B2;
   }

   .program-leasing-page__image {
      overflow: hidden;
      height: 561px;
   }

   .program-leasing-page__image img {
      height: 100%;
      object-position: center;
      object-fit: cover;
   }

   .program-leasing-page__navigation ul {
      display: flex;
      flex-direction: column;
      gap: 30px;
      padding-left: 20px;
      border-left: 2px solid rgba(0, 69, 178, 1)
   }

   .program-leasing-page__navigation ul li a {
      text-wrap: nowrap;
   }

   .program-leasing-page__navigation ul li a:hover {
      color: rgba(0, 69, 178, 1);
   }

   .program-leasing-page__navigation ul li .program__navigation--active {
      text-decoration: underline;
      color: rgba(0, 69, 178, 1);
   }

   .program-leasing-page__navigation h3 {
      font-size: 30px;
      margin-bottom: 43px;

      line-height: 31.22px;
      color: rgba(0, 69, 178, 1);
   }

   .program-leasing-page__content h3 {
      margin: 40px 0 30px 0;
      color: rgba(0, 69, 178, 1);
      font-size: 70px;
      line-height: 84px;
   }

   .program-leasing-page__content p {
      max-width: 1000px;
   }
</style>